project_name = 'test_all'

test_all	= [
	'test_all.c',			\
	'fifo.c',				\
	'../../test/test.c',	\
	'basic.c',				\
	'common.c',				\
	'dispatcher.c',			\
	'dna.c',				\
	'nat.c',				\
	'reconf.c',				\
	'routing_tables.c',		\
	'log.c',				\
]

#libs = ['scalp', 'nanoK']
#libpath = ['scalp', 'nanoK']

#SConscript(['./scalp/SConscript', './nanoK/SConscript'])

debug		= '-DDEBUG_EXTRA=500 '
optimize    = '-O2 '
optimize    = '-fpack-struct -fshort-enums '
includes	= ['.', './scalp', './nanoK', './test']
cflags		= '-g -Wall ' + optimize + debug
ldflags		= '-g -Wall -lrt ' + optimize

env = Environment(
	CC = 'gcc',		\
	AR = 'ar',		\
	CFLAGS = cflags,	\
	CPPPATH = includes,	\
	LINKFLAGS = ldflags,	\
)

#default = env.Program(project_name, test_all, LIBS = libs, LIBPATH = libpath)
default = env.Program(project_name, test_all)
env.Default(default)

# suppress reliquat files
env.Alias('clean', '', 'rm -f *~ *o test_all */*.o */*.a')
env.AlwaysBuild('clean')
